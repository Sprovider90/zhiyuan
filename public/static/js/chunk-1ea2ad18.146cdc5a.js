(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1ea2ad18"],{"19a5":function(e,t,a){},"30b8":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"uploadFileBtn"},[a("el-upload",{ref:"uploadBtn",staticClass:"upload-demo",attrs:{action:"https://jsonplaceholder.typicode.com/posts/","http-request":e.handleUpload,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,limit:1,"on-exceed":e.handleExceed}},[a("el-button",{attrs:{size:"small"}},[e._v(e._s(e.btn))])],1)],1)},n=[],i=(a("3de1"),a("7f43")),o=a.n(i),l={name:"uploadFileBtn",props:["btn","url"],data:function(){return{fileList:[]}},methods:{handleUpload:function(e){var t=this,a=new FormData;a.append("file",e.file),o.a.post(this.url,a,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer "+sessionStorage.getItem("token")}}).then((function(e){t.$emit("afterUpload",e),t.$refs.uploadBtn.clearFiles()})).catch((function(e){console.log(e.response),t.$message.warning(e.response.data.message),t.$refs.uploadBtn.clearFiles()}))},handlePreview:function(){console.log(file)},handleRemove:function(){},beforeRemove:function(){},handleExceed:function(){}}},r=l,c=(a("a248"),a("9ca4")),u=Object(c["a"])(r,s,n,!1,null,null,null);t["a"]=u.exports},3100:function(e,t,a){},"572a":function(e,t,a){},6736:function(e,t,a){"use strict";var s=a("572a"),n=a.n(s);n.a},9225:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"equipment mainPage"},[a("div",{staticClass:"radio-box"},[a("radio-group",{attrs:{size:"middle"},on:{change:e.handleChange}})],1),e._v(" "),a("div",{staticClass:"equipment-item"},[a("ul",{staticClass:"equipment-statics"},[a("li",[a("p",{staticClass:"statics-tit"},[e._v("设备总数")]),e._v(" "),a("p",{staticClass:"statics-acount"},[e._v(e._s(e._f("formatNum")(e.deviceCount.all)))])]),e._v(" "),a("li",[a("p",{staticClass:"statics-tit"},[e._v("在库设备数")]),e._v(" "),a("p",{staticClass:"statics-acount"},[e._v(e._s(e._f("formatNum")(e.deviceCount.in_count)))])]),e._v(" "),a("li",[a("p",{staticClass:"statics-tit"},[e._v("已出库")]),e._v(" "),a("p",{staticClass:"statics-acount"},[e._v(e._s(e._f("formatNum")(e.deviceCount.out_count)))])]),e._v(" "),a("li",[a("p",{staticClass:"statics-tit"},[e._v("运行中设备数")]),e._v(" "),a("p",{staticClass:"statics-acount"},[e._v(e._s(e._f("formatNum")(e.deviceCount.run_count)))])])])]),e._v(" "),a("div",{staticClass:"equipment-item"},[a("div",{staticClass:"filterBox"},[a("div",{staticClass:"filterItem"},[a("span",[e._v("库存状态：")]),e._v(" "),a("el-select",{attrs:{clearable:"",size:"small",placeholder:"请选择"},model:{value:e.searchInfo.store_status,callback:function(t){e.$set(e.searchInfo,"store_status",t)},expression:"searchInfo.store_status"}},[a("el-option",{attrs:{label:"未出库",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"已出库",value:"2"}})],1)],1),e._v(" "),a("div",{staticClass:"filterItem"},[a("span",[e._v("运行状态：")]),e._v(" "),a("el-select",{attrs:{clearable:"",size:"small",placeholder:"请选择"},model:{value:e.searchInfo.run_status,callback:function(t){e.$set(e.searchInfo,"run_status",t)},expression:"searchInfo.run_status"}},[a("el-option",{attrs:{label:"运行中",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"已停止",value:"2"}})],1)],1),e._v(" "),a("br"),e._v(" "),a("div",{staticClass:"filterItem"},[a("span"),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.handleSearch}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:e.handleReset}},[e._v("重置查询条件")])],1)])]),e._v(" "),a("div",{staticClass:"equipment-item"},[a("div",{staticClass:"filterBox"},[a("el-button",{directives:[{name:"btnRole",rawName:"v-btnRole",value:24,expression:"24"}],attrs:{size:"small",type:"primary"},on:{click:e.handleCreate}},[e._v("新增设备")]),e._v(" "),a("uploadFileBtn",{attrs:{btn:"批量导入",url:e.ajaxUrl.importDevice},on:{afterUpload:e.afterUpload}}),e._v(" "),a("a",{directives:[{name:"btnRole",rawName:"v-btnRole",value:25,expression:"25"}],attrs:{href:"http://47.93.41.147"+e.ajaxUrl.downloadTemlpate,download:"导入模板"}},[a("el-button",{attrs:{size:"small"}},[e._v("下载导入模板")])],1),e._v(" "),a("el-input",{staticClass:"keywords fr",attrs:{size:"small",placeholder:"请输入产品名称或设备id"},model:{value:e.device_number,callback:function(t){e.device_number=t},expression:"device_number"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handlePreciseSearch},slot:"append"})],1)],1),e._v(" "),a("div",{staticClass:"tableContent"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableContent,border:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{prop:"device_number",label:"设备id",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"产品名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n\t\t\t\t\t\t\t全能空气检测器\n\t\t\t\t\t\t")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"出厂日期",prop:"come_date",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{width:"120",label:"设备型号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n\t\t\t\t\t\t\t"+e._s(e.deviceTypeTxt(t.row.model))+"\n\t\t\t\t\t\t")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"manufacturer",width:"120",label:"生产厂家"}}),e._v(" "),a("el-table-column",{attrs:{width:"120",label:"设备状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[1===t.row.status?a("span",[e._v("正常")]):e._e(),e._v(" "),2===t.row.status?a("span",[e._v("维修")]):e._e(),e._v(" "),3===t.row.status?a("span",[e._v("损坏")]):e._e()])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"所属客户"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n\t\t\t\t\t\t\t"+e._s(t.row.customer[0]&&t.row.customer[0].company_name)+"\n\t\t\t\t\t\t")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left",width:"180",label:"运行状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[1===t.row.run_status?a("span",{staticClass:"text-dot color1"},[e._v("运行中")]):e._e(),e._v(" "),2===t.row.run_status?a("span",{staticClass:"text-dot color2"},[e._v("已停止")]):e._e()])]}}])}),e._v(" "),a("el-table-column",{attrs:{width:"120",label:"检测指标数"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n\t\t\t\t\t\t\t"+e._s(t.row.check_data&&t.row.check_data.split(",").length||0)+"\n\t\t\t\t\t\t")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[1!=t.row.run_status?[a("el-button",{directives:[{name:"btnRole",rawName:"v-btnRole",value:26,expression:"26"}],attrs:{size:"mini",type:"text"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("编辑")]),e._v(" "),t.row.customer[0]?a("el-button",{directives:[{name:"btnRole",rawName:"v-btnRole",value:27,expression:"27"}],attrs:{size:"mini",type:"text"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("收回")]):e._e()]:e._e()]}}])})],1),e._v(" "),a("myPagination",{attrs:{pageInfo:e.pageInfo},on:{"current-change":e.pageChange}})],1)]),e._v(" "),a("el-dialog",{attrs:{title:(e.editId?"编辑":"新增")+"设备",visible:e.dialogShow,"before-close":e.handleClose,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(t){e.dialogShow=t}}},[a("el-form",{ref:"equipmentForm",staticClass:"warehouseForm form-inline",attrs:{model:e.formData,rules:e.rules,"label-position":"top","label-width":"100px"}},[a("el-form-item",{staticClass:"form-item-inline",attrs:{label:"产品名称"}},[a("el-input",{attrs:{size:"small",value:"全能空气检测器",disabled:""}})],1),e._v(" "),a("el-form-item",{staticClass:"form-item-inline",attrs:{label:"设备SN",prop:"device_number"}},[a("el-input",{attrs:{size:"small",disabled:!!e.editId,placeholder:"请填写设备SN"},model:{value:e.formData.device_number,callback:function(t){e.$set(e.formData,"device_number",t)},expression:"formData.device_number"}})],1),e._v(" "),a("el-form-item",{staticClass:"form-item-inline",attrs:{label:"出厂时间",prop:"come_date"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",size:"small",type:"date",placeholder:"选择日期"},model:{value:e.formData.come_date,callback:function(t){e.$set(e.formData,"come_date",t)},expression:"formData.come_date"}})],1),e._v(" "),a("el-form-item",{staticClass:"form-item-inline",attrs:{label:"所属型号",prop:"model"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择设备型号"},model:{value:e.formData.model,callback:function(t){e.$set(e.formData,"model",t)},expression:"formData.model"}},e._l(e.deviceType,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),a("el-form-item",{staticClass:"form-item-inline",attrs:{label:"生产厂家",prop:"manufacturer"}},[a("el-input",{attrs:{size:"small",placeholder:"请填写生产厂家"},model:{value:e.formData.manufacturer,callback:function(t){e.$set(e.formData,"manufacturer",t)},expression:"formData.manufacturer"}})],1),e._v(" "),a("el-form-item",{staticClass:"form-item-inline",attrs:{label:"入库仓库",prop:"storehouse_id"}},[a("el-select",{attrs:{size:"small",placeholder:"请选择入库仓库"},model:{value:e.formData.storehouse_id,callback:function(t){e.$set(e.formData,"storehouse_id",t)},expression:"formData.storehouse_id"}},e._l(e.warehouseList,(function(e){return a("el-option",{directives:[{name:"show",rawName:"v-show",value:!(2===e.status),expression:"!(item.status===2)"}],key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),a("el-form-item",{staticClass:"form-item-inline",attrs:{label:"所属客户"}},[a("el-select",{attrs:{size:"small",clearable:"",filterable:"",placeholder:"请选择所属客户"},model:{value:e.formData.customer_id,callback:function(t){e.$set(e.formData,"customer_id",t)},expression:"formData.customer_id"}},e._l(e.customerList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.company_name,value:e.id}})})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"监测数据",prop:"check_data"}},[a("el-checkbox-group",{model:{value:e.formData.check_data,callback:function(t){e.$set(e.formData,"check_data",t)},expression:"formData.check_data"}},e._l(e.monitorList,(function(t){return a("el-checkbox",{key:t.id,attrs:{label:t.id}},[e._v(e._s(t.name))])})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"库存状态",prop:"status"}},[a("el-radio-group",{attrs:{size:"small"},model:{value:e.formData.status,callback:function(t){e.$set(e.formData,"status",t)},expression:"formData.status"}},[a("el-radio-button",{attrs:{label:"1"}},[e._v("正常")]),e._v(" "),a("el-radio-button",{attrs:{label:"2"}},[e._v("维修")]),e._v(" "),a("el-radio-button",{attrs:{label:"3"}},[e._v("损坏")])],1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small"},on:{click:e.handleCancel}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.handleSubmit}},[e._v("提交")])],1)],1)],1)],1)},n=[],i=(a("163d"),a("9a33"),a("cc57"),a("c85d")),o=a("de9f"),l=a("30b8"),r=a("b775"),c={name:"equipment",data:function(){return{editId:0,dialogShow:!1,deviceCount:{all:0,in_count:0,out_count:0,run_count:0},formData:{device_number:"",come_date:"",model:"",manufacturer:"",storehouse_id:"",check_data:[],status:"",customer_id:""},deviceType:[],monitorList:[],warehouseList:[],customerList:[],rules:{name:[{required:!0,message:"请输入设备名称",trigger:"blur"}],device_number:[{required:!0,message:"请输入设备SN编号",trigger:"blur"}],come_date:[{required:!0,message:"请选择出厂日期",trigger:"blur"}],model:[{required:!0,message:"请选择设备所属型号",trigger:"blur"}],manufacturer:[{required:!0,message:"请输入生产厂家",trigger:"blur"}],storehouse_id:[{required:!0,message:"请选择入库仓库",trigger:"blur"}],check_data:[{required:!0,message:"请选择监测数据",trigger:"blur"}],status:[{required:!0,message:"请选择设备库存状态",trigger:"click"}]},device_number:"",searchInfo:{store_status:"",run_status:""},tableContent:[],multipleSelection:[],pageInfo:{total:0,pageSize:20,currentPage:1}}},created:function(){this.monitorList=this.$store.getters.dictionary.filter((function(e){return"jianceshuju"===e.nameflag}))[0].value,this.deviceType=this.$store.getters.dictionary.filter((function(e){return"suoshuxinghao"===e.nameflag}))[0].value,this.getCustomsList(),this.getWarehouseList(),this.getDeviceCount(1),this.getDeviceList()},methods:{deviceTypeTxt:function(e){return this.deviceType.filter((function(t){return t.id===e}))[0].name},afterUpload:function(e){console.log(e,"222222222")},getDeviceCount:function(e){var t=this;Object(r["a"])(this.ajaxUrl.deviceCount,{type:e},"get").then((function(e){t.deviceCount=e})).catch((function(e){console.log(e)}))},getCustomsList:function(){var e=this;Object(r["a"])(this.ajaxUrl.customsList,{pageSize:99999,page:1},"get").then((function(t){e.customerList=t.data})).catch((function(e){console.log(e)}))},getWarehouseList:function(){var e=this;Object(r["a"])(this.ajaxUrl.storeHouses,{page:1,pageSize:99999},"get").then((function(t){e.warehouseList=t.data})).catch((function(e){console.log(e)}))},getDeviceList:function(){var e=this;Object(r["a"])(this.ajaxUrl.deviceList,{page:this.pageInfo.currentPage,pageSize:this.pageInfo.pageSize,run_status:this.searchInfo.run_status,store_status:this.searchInfo.store_status,device_number:this.device_number},"get").then((function(t){e.tableContent=t.data,e.pageInfo.total=t.total})).catch((function(e){console.log(e)}))},handleChange:function(e){this.getDeviceCount(e)},pageChange:function(e){this.pageInfo.currentPage=e,this.getDeviceList()},handleSearch:function(){this.device_number="",this.pageInfo.currentPage=1,this.getDeviceList()},handlePreciseSearch:function(){this.handleReset(),this.pageInfo.currentPage=1,this.getDeviceList()},handleReset:function(){this.searchInfo.store_status="",this.searchInfo.run_status=""},handleCreate:function(){this.editId=0,this.dialogShow=!0},handleClose:function(e){this.$refs["equipmentForm"].resetFields(),e()},handleCancel:function(){this.$refs["equipmentForm"].resetFields(),this.dialogShow=!1},handleSubmit:function(){var e=this;this.$refs["equipmentForm"].validate((function(t){if(!t)return console.log("error submit!!"),!1;e.editId?Object(r["a"])(e.ajaxUrl.editDevice+e.editId,{device_number:e.formData.device_number,come_date:e.formData.come_date,model:e.formData.model,manufacturer:e.formData.manufacturer,storehouse_id:e.formData.storehouse_id,check_data:e.formData.check_data.join(","),customer_id:e.formData.customer_id,status:e.formData.status},"put").then((function(t){e.$message.success("设备编辑成功"),e.getDeviceList(),e.$refs["equipmentForm"].resetFields(),e.dialogShow=!1})).catch((function(e){console.log(e)})):Object(r["a"])(e.ajaxUrl.addDevice,{device_number:e.formData.device_number,come_date:e.formData.come_date,model:e.formData.model,manufacturer:e.formData.manufacturer,storehouse_id:e.formData.storehouse_id,check_data:e.formData.check_data.join(","),customer_id:e.formData.customer_id,status:e.formData.status},"post").then((function(t){e.$message.success("设备新增成功"),e.$refs["equipmentForm"].resetFields(),e.getDeviceList(),e.dialogShow=!1})).catch((function(e){console.log(e)}))}))},handleEdit:function(e){var t=this;this.editId=e.id,this.dialogShow=!0;var a=JSON.parse(JSON.stringify(e));a.check_data=e.check_data.split(",").map((function(e){return Number(e)})),this.$nextTick((function(){t.formData=a}))},handleDelete:function(e){var t=this;this.$confirm("是否回收该设备","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(r["a"])(t.ajaxUrl.recycleDevice+e.id+"/cancel",{},"put").then((function(e){t.$message({type:"success",message:"回收成功!"}),t.getDeviceList()})).catch((function(e){console.log(e)}))})).catch((function(){}))},handleSelectionChange:function(e){this.multipleSelection=e},handleCurrentChange:function(e){this.pageInfo.currentPage=e,this.getDeviceList()}},components:{myPagination:o["a"],radioGroup:i["a"],uploadFileBtn:l["a"]}},u=c,d=(a("fc7e"),a("9ca4")),m=Object(d["a"])(u,s,n,!1,null,null,null);t["default"]=m.exports},a248:function(e,t,a){"use strict";var s=a("3100"),n=a.n(s);n.a},c499:function(e,t,a){},c6876:function(e,t,a){"use strict";var s=a("c499"),n=a.n(s);n.a},c85d:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ul",{staticClass:"radioGroup",class:this.size},[a("li",{class:{on:1===e.active},on:{click:function(t){return e.handleClick(1)}}},[e._v("本周")]),e._v(" "),a("li",{class:{on:2===e.active},on:{click:function(t){return e.handleClick(2)}}},[e._v("本月")]),e._v(" "),a("li",{class:{on:3===e.active},on:{click:function(t){return e.handleClick(3)}}},[e._v("本年")])])},n=[],i={name:"radioGroup",props:["size"],data:function(){return{active:1}},mounted:function(){},methods:{handleClick:function(e){this.active=e,this.$emit("change",this.active)},reset:function(){this.active=""}}},o=i,l=(a("c6876"),a("9ca4")),r=Object(l["a"])(o,s,n,!1,null,null,null);t["a"]=r.exports},de9f:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"myPagination"},[a("div",{staticClass:"total"},[e._v("\n        共"+e._s(e.pageInfo.total)+"条数据，"+e._s(Math.ceil(e.pageInfo.total/e.pageInfo.pageSize))+"页\n    ")]),e._v(" "),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-size":e.pageInfo.pageSize,"current-page":e.pageInfo.currentPage,total:e.pageInfo.total},on:{"current-change":e.handleCurrentChange}})],1)},n=[],i={name:"myPagination",props:["pageInfo"],data:function(){return{}},created:function(){},methods:{handleCurrentChange:function(e){this.$emit("current-change",e)}}},o=i,l=(a("6736"),a("9ca4")),r=Object(l["a"])(o,s,n,!1,null,"dabd56de",null);t["a"]=r.exports},fc7e:function(e,t,a){"use strict";var s=a("19a5"),n=a.n(s);n.a}}]);