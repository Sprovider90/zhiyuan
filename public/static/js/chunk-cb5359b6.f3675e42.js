(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-cb5359b6"],{"572a":function(t,e,a){},"5cff":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"orderManager"},[a("router-view"),t._v(" "),t.listShow?[a("div",{staticClass:"radio-box"},[a("radio-group",{ref:"radioGroup",on:{change:t.handleChange}})],1),t._v(" "),a("div",{staticClass:"box-flex"},[a("div",{staticClass:"block"},[a("div",{staticClass:"text"},[a("span",{staticClass:"font-color"},[t._v("订单总额")]),t._v(" "),a("p",{staticClass:"number"},[a("span",[t._v("￥")]),t._v(t._s(t._f("formatPrice")(t.count.order_money_count,"none")))])]),t._v(" "),a("div",{staticClass:"text"},[a("span",{staticClass:"font-color"},[t._v("待付款")]),t._v(" "),a("p",{staticClass:"number"},[a("span",[t._v("￥")]),t._v(t._s(t._f("formatPrice")(t.count.wait_money_count,"none")))])]),t._v(" "),a("div",{staticClass:"text"},[a("span",{staticClass:"font-color"},[t._v("已收款")]),t._v(" "),a("p",{staticClass:"number"},[a("span",[t._v("￥")]),t._v(t._s(t._f("formatPrice")(t.count.receive_money_count,"none")))])]),t._v(" "),a("div",{staticClass:"text noborder"},[a("span",{staticClass:"font-color"},[t._v("已退款")]),t._v(" "),a("p",{staticClass:"number"},[a("span",[t._v("￥")]),t._v(t._s(t._f("formatPrice")(t.count.exit_money_count,"none")))])])])]),t._v(" "),a("div",{staticClass:"box-input"},[a("el-form",{staticClass:"formItem",attrs:{model:t.searchInfo,inline:!0}},[a("el-form-item",{staticClass:"formItem2",attrs:{prop:"namePy",label:"客户名称"}},[a("el-input",{attrs:{placeholder:"请输入",size:"small",clearable:""},model:{value:t.searchInfo.name,callback:function(e){t.$set(t.searchInfo,"name","string"===typeof e?e.trim():e)},expression:"searchInfo.name"}})],1),t._v(" "),a("el-form-item",{staticClass:"formItem4",attrs:{prop:"namePy",label:"订单状态"}},[a("el-select",{attrs:{clearable:"",size:"small",placeholder:"请选择"},model:{value:t.searchInfo.status,callback:function(e){t.$set(t.searchInfo,"status",e)},expression:"searchInfo.status"}},t._l(t.payStatus,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.handleSearch()}}},[t._v("查 询")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"text"},on:{click:function(e){return t.handleReset()}}},[t._v("重置查询条件")])],1),t._v(" "),a("div",{staticClass:"box-card"},[a("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.financialList,border:"",fit:""}},[a("el-table-column",{attrs:{prop:"order_number",label:"订单编号","header-align":"left"}}),t._v(" "),a("el-table-column",{attrs:{label:"客户名称",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n\t\t\t\t\t\t\t"+t._s(e.row.customs&&e.row.customs.company_name)+"\n\t\t\t\t\t\t")]}}],null,!1,2758844260)}),t._v(" "),a("el-table-column",{attrs:{prop:"created_at",label:"创建时间",align:"left",width:"240"}}),t._v(" "),a("el-table-column",{attrs:{label:"订单金额",align:"left",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("formatPrice")(e.row.money)))])]}}],null,!1,107522625)}),t._v(" "),a("el-table-column",{attrs:{prop:"status",label:"订单状态",align:"left",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"table-status",class:"color"+e.row.order_status},[a("span",[t._v(t._s(t.publicObj.orderStatus[e.row.order_status]))])])]}}],null,!1,3955186161)}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"left"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{directives:[{name:"btnRole",rawName:"v-btnRole",value:28,expression:"28"}],attrs:{type:"text"},on:{click:function(a){return t.$router.push({name:"financialDetail",params:{id:e.row.id}})}}},[t._v("查看")]),t._v(" "),1===e.row.order_status||3===e.row.order_status?a("el-button",{directives:[{name:"btnRole",rawName:"v-btnRole",value:29,expression:"29"}],attrs:{type:"text"},on:{click:function(a){return t.handleFinance(e.row,1)}}},[t._v("收款")]):t._e(),t._v(" "),2===e.row.order_status||3===e.row.order_status?a("el-button",{directives:[{name:"btnRole",rawName:"v-btnRole",value:30,expression:"30"}],attrs:{type:"text"},on:{click:function(a){return t.handleFinance(e.row,2)}}},[t._v("退款")]):t._e()]}}],null,!1,2546163668)})],1),t._v(" "),a("div",{staticClass:"pagination"},[a("myPagination",{attrs:{pageInfo:t.pageInfo},on:{"current-change":t.pageChange}})],1)],1)]:t._e(),t._v(" "),a("el-dialog",{attrs:{title:"订单"+(1===t.type?"收款":"退款"),visible:t.dialogVisible,"close-on-click-modal":!1,"before-close":t.handleBeforeClose,width:"600px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"financeForm",staticClass:"warehouseForm form-inline",attrs:{model:t.formData,rules:t.rules,"label-position":"top","label-width":"100px"}},[a("el-form-item",{staticClass:"form-item-inline",attrs:{label:"客户名称"}},[a("el-input",{attrs:{value:t.formData.name,disabled:""}})],1),t._v(" "),a("el-form-item",{staticClass:"form-item-inline",attrs:{label:"订单金额"}},[a("el-input",{attrs:{value:"￥"+t.formData.orderMoney,disabled:""}})],1),t._v(" "),a("el-form-item",{staticClass:"form-item-inline",attrs:{label:1===t.type?"待付款金额":"可退款金额"}},[a("el-input",{attrs:{value:"￥"+t.formData.waitMoney,disabled:""}})],1),t._v(" "),a("el-form-item",{staticClass:"form-item-inline",attrs:{label:"本次"+(1===t.type?"付款":"退款")+"金额",prop:"money"}},[a("el-input",{attrs:{placeholder:"请填写本次"+(1===t.type?"付款":"退款")+"金额"},model:{value:t.formData.money,callback:function(e){t.$set(t.formData,"money",e)},expression:"formData.money"}})],1),t._v(" "),a("el-form-item",{staticClass:"form-item-inline",attrs:{label:1===t.type?"付款方式":"退款方式",prop:"pay_type"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.formData.pay_type,callback:function(e){t.$set(t.formData,"pay_type",e)},expression:"formData.pay_type"}},[a("el-option",{attrs:{label:"对公转账",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"微信",value:"2"}}),t._v(" "),a("el-option",{attrs:{label:"支付宝",value:"3"}}),t._v(" "),a("el-option",{attrs:{label:"现金",value:"4"}}),t._v(" "),a("el-option",{attrs:{label:"其他",value:"5"}})],1)],1),t._v(" "),a("el-form-item",{staticClass:"form-item-inline",attrs:{label:1===t.type?"付款日期":"退款日期",prop:"date"}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:t.formData.date,callback:function(e){t.$set(t.formData,"date",e)},expression:"formData.date"}})],1),t._v(" "),a("el-form-item",[a("el-upload",{ref:"uploadCom",attrs:{action:"","http-request":t.handleUpload,"on-remove":t.handleRemove}},[a("span",{staticClass:"evidence"},[t._v(t._s(1===t.type?"付款凭证":"退款凭证"))]),a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("上传文件")]),t._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg,png文件，单个文件不超过500kb")])],1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{size:"small"},on:{click:t.handleCancel}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.handleSubmit}},[t._v("提交")])],1)],1)],1)],2)},i=[],l=(a("cc57"),a("c85d")),o=a("de9f"),s=a("b775"),r=a("3de1"),c={name:"financialList",components:{myPagination:o["a"],radioGroup:l["a"]},data:function(){return{listShow:!1,financialId:"",searchInfo:{name:"",status:""},count:{},formData:{name:"",orderMoney:"",waitMoney:"",money:"",pay_type:"",date:"",file:""},uploadIdList:[],fileUidList:[],timeType:1,financialList:[],dialogVisible:!1,type:"",payStatus:[{value:1,label:"待付款"},{value:2,label:"已付款"},{value:3,label:"部分付款"},{value:4,label:"已退款"},{value:5,label:"已取消"}],pageInfo:{total:0,pageSize:20,currentPage:1},rules:{money:[{required:!0,message:"请输入本次 付款/退款 金额",trigger:"blur"}],pay_type:[{required:!0,message:"请选择 付款/退款 方式",trigger:"blur"}],date:[{required:!0,message:"请选择 付款 日期",trigger:"blur"}]}}},created:function(){"financialList"===this.$route.name?(this.listShow=!0,this.getCount(),this.getList()):this.listShow=!1},mounted:function(){},methods:{handleUpload:function(t){var e=this;Object(r["i"])(t.file).then((function(a){e.uploadIdList.push(a.id),e.fileUidList.push(t.file.uid)})).catch((function(t){console.log(t)}))},handleRemove:function(t){var e=this.fileUidList.indexOf(t.uid);this.fileUidList.splice(e,1),this.uploadIdList.splice(e,1)},getCount:function(){var t=this;Object(s["a"])(this.ajaxUrl.financialCount,{type:this.timeType},"get").then((function(e){t.count=e})).catch((function(t){console.log(t)}))},handleSearch:function(){console.log(this.searchInfo),this.getList()},handleReset:function(){this.searchInfo={name:"",status:""}},getList:function(){var t=this;Object(s["a"])(this.ajaxUrl.financialList,{pageSize:this.pageInfo.pageSize,page:this.pageInfo.currentPage,name:this.searchInfo.name,status:this.searchInfo.status},"get").then((function(e){t.financialList=e.data,t.pageInfo.total=e.total})).catch((function(t){console.log(t)}))},handleChange:function(t){this.timeType=t,this.getCount()},handleSubmit:function(){var t=this;this.$refs["financeForm"].validate((function(e){if(!e)return console.log("error Submit"),!1;var a=t.uploadIdList.join(",");a?Object(s["a"])(t.ajaxUrl.financialMethods+t.financialId,{type:t.type,money:t.formData.money,pay_type:t.formData.pay_type,file:a,date:t.formData.date},"put").then((function(e){t.$message.success("操作成功"),t.dialogVisible=!1,t.getList(),t.resetForm()})).catch((function(t){console.log(t)})):t.$message.warning("请上传收款/退款凭证")}))},handleCancel:function(){this.dialogVisible=!1,this.resetForm()},handleBeforeClose:function(t){this.resetForm(),t()},resetForm:function(){this.formData={name:"",orderMoney:"",waitMoney:"",money:"",pay_type:"",date:"",file:""},this.uploadIdList=[],this.fileUidList=[],this.$refs["uploadCom"].clearFiles()},pageChange:function(t){this.pageInfo.currentPage=t},check:function(){this.$router.push({name:"financialDetail"})},handleFinance:function(t,e){var a=this;this.type=e,this.financialId=t.id,Object(s["a"])(this.ajaxUrl.financialInfo+t.id,{},"get").then((function(t){a.formData.name=t.customs.company_name,a.formData.orderMoney=t.money,a.formData.waitMoney=1===e?t.wait_put_moeny:t.wait_back_meony,a.formData.money=1===e?t.wait_put_moeny:t.wait_back_meony,a.dialogVisible=!0})).catch((function(t){console.log(t)}))}},watch:{chartData:function(t,e){this.initChart(this.chartData)}}},u=c,f=(a("811b"),a("9ca4")),m=Object(f["a"])(u,n,i,!1,null,"4bdaddb4",null);e["default"]=m.exports},6736:function(t,e,a){"use strict";var n=a("572a"),i=a.n(n);i.a},"811b":function(t,e,a){"use strict";var n=a("d282"),i=a.n(n);i.a},c499:function(t,e,a){},c6876:function(t,e,a){"use strict";var n=a("c499"),i=a.n(n);i.a},c85d:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{staticClass:"radioGroup",class:this.size},[a("li",{class:{on:1===t.active},on:{click:function(e){return t.handleClick(1)}}},[t._v("本周")]),t._v(" "),a("li",{class:{on:2===t.active},on:{click:function(e){return t.handleClick(2)}}},[t._v("本月")]),t._v(" "),a("li",{class:{on:3===t.active},on:{click:function(e){return t.handleClick(3)}}},[t._v("本年")])])},i=[],l={name:"radioGroup",props:["size"],data:function(){return{active:1}},mounted:function(){},methods:{handleClick:function(t){this.active=t,this.$emit("change",this.active)},reset:function(){this.active=""}}},o=l,s=(a("c6876"),a("9ca4")),r=Object(s["a"])(o,n,i,!1,null,null,null);e["a"]=r.exports},d282:function(t,e,a){},de9f:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"myPagination"},[a("div",{staticClass:"total"},[t._v("\n        共"+t._s(t.pageInfo.total)+"条数据，"+t._s(Math.ceil(t.pageInfo.total/t.pageInfo.pageSize))+"页\n    ")]),t._v(" "),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-size":t.pageInfo.pageSize,"current-page":t.pageInfo.currentPage,total:t.pageInfo.total},on:{"current-change":t.handleCurrentChange}})],1)},i=[],l={name:"myPagination",props:["pageInfo"],data:function(){return{}},created:function(){},methods:{handleCurrentChange:function(t){this.$emit("current-change",t)}}},o=l,s=(a("6736"),a("9ca4")),r=Object(s["a"])(o,n,i,!1,null,"dabd56de",null);e["a"]=r.exports}}]);